\documentclass[a4paper,10pt]{article}

\usepackage{../mathbf-abbrevs}

\input{defs}

\usepackage{tikz}
\usepackage{pgfplots}
\usetikzlibrary{calc}

%opening
\title{The number of lattices of Voronoi's first kind}
\author{Robby McKilliam}
\date{\today}

\begin{document} 

\maketitle

% This document describes an algorithm to determine whether a lattice, specified by a basis matrix, is of Voronoi's first kind.  The algorithm returns an obtuse superbase for the lattice if the lattice is of Vornoi's first kind.

% An $n$-dimensional lattice $\Lambda$ is said to be of \emph{Voronoi's first kind} if it has what is called an \emph{obtuse superbasis}~\cite{ConwaySloane1992_voronoi_lattice_3d_obtuse_superbases}.  That is, there exists a set of $n+1$ vectors $b_1,\dots,b_{n+1}$ such that $b_1,\dots,b_n$ are a basis for $\Lambda$,
% \begin{equation}\label{eq:superbasecond}
% b_1 + b_2 \dots + b_{n+1} = 0
% \end{equation}
% (the \emph{superbasis} condition), and the inner products satisfy
% \begin{equation}\label{eq:obtusecond}
% q_{ij} = b_i \cdot b_j \leq 0, \qquad \text{for} \qquad i,j = 1,\dots,n+1, i \neq j
% \end{equation}
% (the \emph{obtuse} condition).  The $q_{ij}$ are called the \emph{Selling parameters}~\cite{Selling1874}.  It is known that all lattices in dimensions less than $4$ are of Voronoi's first kind~\cite{ConwaySloane1992_voronoi_lattice_3d_obtuse_superbases}.  An interesting property of lattices of Voronoi's first kind is that their relevant vectors have a straightforward description.

% \begin{theorem} \label{thm:revvecssuperbase} (Conway and Sloane~\cite[Theorem~3]{ConwaySloane1992_voronoi_lattice_3d_obtuse_superbases})
% The relevant vectors of $\Lambda$ are of the form,
% \[
% \sum_{i \in I} b_i
% \]
% where $I$ is a strict subset of $\{1, 2, \dots, n+1\}$ that is not empty, i.e., $I \subset \{1, 2, \dots, n+1\}$ and $I \neq \emptyset$.
% \end{theorem}  

% Notes: 
% \begin{itemize}
% \item Need definition of `strict' and `lax' relevant vectors. 
% \item How many lax relevant vectors can there be (presumably this comes the integer lattice, so $3^{n}-1$?)
% \item Are vectors from a superbase always strict?  Can probably show this using the arguments in Conway and Sloane's paper.
% \end{itemize}

% Our algorithm begins by enumerating a superset $R$ of the set of relevant vectors $\relevant(\Lambda)$.  This can be achieved using the algorithm of Micciancio and Voulgaris~\cite{Micciancio09adeterministic} or the algorithm described by Agrell~et.~al.~\cite[Sec.~VI.C]{Agrell2002}.  In many cases these algorithms will return precisely the set of relevant vectors and so $R = \relevant(\Lambda)$, but for what follows it is sufficient if $R \supseteq \relevant(\Lambda)$.

% If $\Lambda$ is of first kind then, by Theorem~\ref{thm:revvecssuperbase}, the vectors $b_1,\dots,b_{n+1}$ from the obtuse superbase are contained in $R$.  A straightforward procedure to determine whether the lattice is of first kind consists of enumerating all $\binom{\abs{R}}{n+1}$ combinations of $n+1$ vectors from $R$ and checking whether any combination forms a superbase.  That is, let $v_1,\dots,v_{n+1}$ be a set of $n+1$ distinct vectors from $R$.  If both $v_1+\dots + v_{n+1} = 0$ and $\dotprod{v_{i}}{v_{j}} \leq 0$ for all $i \neq j$ then the lattice is of first kind with superbase is $v_1,\dots,v_{n+1}$.  If no such combination of vectors exists in $R$, then the lattice is not of first kind.

% In general there are as many as $2^{n+1}-2$ relevant vectors (BLERG strict, lax etc?)

The plot shows the estimated (after 5000 trials) probability of obtaining a lattice of Voronoi's first kind for $n=1,2,3,4,5,6$.  Three different methods for generating the $n \times n$ basis matrix $B$ are considered: 
\begin{enumerate}
\item entries drawn independently and uniformly in the interval $[0,1]$, 
\item entries drawn independently and Gaussian with zero mean and variance one, and 
\item the $i,j$th entry satisfies
\[
B_{i,j} = \begin{cases}
R_{i,j} & 1 \leq i,j \leq h \\
-C_{i-h,j} & h < i \leq n, 1 \leq j \leq h \\
C_{i,j-h} & h < j \leq n, 1 \leq i \leq h \\
R_{i-h,j-h} & h < i,j \leq n,
\end{cases}
\] 
where $h = \ceil{n/2}$ is the smallest integer greater than or equal to $n/2$ and $R_{i,j}$ and $C_{i,j}$ for $i,j = 1,\dots,h$ are independently Gaussian distributed with zero mean and variance one. 
\end{enumerate}
When $n$ is even, the third case corresponds with the model commonly used for MIMO channels, that is, the basis matrix is of the form
\[
B = \left(\begin{array}{cc}
R & -C \\
C & R
\end{array}\right)
\]
where $R$ and $C$ are $\tfrac{n}{2} \times \tfrac{n}{2}$ matrices containing the real and imaginary parts of the channel coefficients.

As expected, all lattices generated in dimensions 1, 2, and 3 were found to be of Voronoi's first kind.  When $n=4$ roughly 25\% of the lattices generated by methods 1 and 2 were of Voronoi's first kind, but none of the 5000 bases generated by method 3 were of first kind for $n=4$.  When $n=5$ approximately 2\% of the lattices generated were of first kind for all 3 generation methods.  When $n=6$ less than 1\% of the lattices generated by methods 1 and 2 where of first kind and approximately 1\% of the lattices generated by method 3 where of first kind.

It is interesting that none of the lattices corresponding with MIMO channel matrices are of first kind in dimension 4, but there are some in dimension 6. 

%I find this very interesting! The simulations suggest that the lattices of Voronoi's first kind do not lie within a space of measure zero with respect to the measures induced by the first two generation methods, but that they do lie on a space of measure zero with respect to the lattices that occur when converting complex valued MIMO channel matrices into real valued lattice bases.  This might suggest that lattices of first kind will not be useful for MIMO (at least not directly).

%It would be interesting to see if these conclusion hold in higher dimension. I was too optimistic when I thought I would be able to run this with $n=6$.  This would take too long with the existing code.  There are a number of optimisations that can be made that might make running simulations with $n=6$ possible.

\begin{figure}[tp]
\centering 
  \begin{tikzpicture}
    \begin{axis}[ymode=log,font=\footnotesize,clip mode=individual,height=7cm,width=9cm,legend style={draw=none,fill=none,legend pos=south west,font=\footnotesize},xlabel=$n$,ylabel={Probability}]    
      \addplot[mark=*,color=red,only marks,/pgfplots/error bars/.cd,
        x dir=none,
        y dir=both,
        y explicit] table[x=n,y=proportion,y error=stddev] {code/data/uniform};
      \addplot[mark=square,color=blue,only marks,/pgfplots/error bars/.cd,
        x dir=none,
        y dir=both,
        y explicit] table[x=n,y=proportion,y error=stddev] {code/data/gaussian};
      \addplot[mark=x,color=green,only marks,/pgfplots/error bars/.cd, 
        x dir=none,
        y dir=both,
        y explicit] table[x=n,y=proportion,y error=stddev] {code/data/mimo};
\legend{Uniform, Gaussian, MIMO}
    \end{axis}
  \end{tikzpicture}
\caption{Estimated probability of generating a lattices of Voronoi's first kind for different basis distributions and dimension $n=1,2,3,4,5,6$.}
\end{figure}




 
%\bibliography{../bib}

\end{document}
